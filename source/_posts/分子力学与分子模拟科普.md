---
title: 分子力学与分子模拟
mathjax: true
date: 2019-02-23 16:07:01
id: force-field-method
tags:
- 科普
- 学习
- 力学
categories:
- 学习
- 科普
---

分子力学，又叫力场方法（force field method），目前广泛地用于计算分子的构象和能量。分子力学从本质上说上是能量最小值方法，即在原子间相互作用势的作用下, 通过改变粒子分布的几何位型,以能量最小为判据,从而获得体系的最佳结构。

<!---more--->  

## 分子力学

### 分子力学的基本思想

在分子内部，化学键都有“自然”的键长值和键角值。分子要调整它的几何形状（构象），以使其键长值和键角值尽可能接近自然值，同时也使非键作用（van der Waals力）处于最小的状态，给出原子核位置的最佳排布。

### 分子力学的基本假设

**原子核的运动与电子的运动可以看成是独立的**

>分子是一组靠各种作用力维系在一起的原子集合。这些原子在空间上若过于靠近，便相互排斥；但又不能远离，否则连接它们的化学键以及由这些键构成的键角等会发生变化，即出现键的拉伸或压缩、键角的扭变等，会引起分子内部应力的增加。每个真实的分子结构，都是在上述几种作用达到平衡状态的表现。

### 分子力学与量子化学计算的区别

>**分子力学是一种经验方法，其力场是在大量的实验数据的基础上产生的。**分子力学宜用于对大分子进行构象分析、研究与空间效应密切相关的有机反应机理、反应活性、有机物的稳定性及生物活性分子的构象与活性的关系；但是，当研究对象与所用的分子力学力场参数化基于的分子集合相差甚远时不宜使用，当然也不能用于人们感兴趣但没有足够多的实验数据的新类型的分子。
>
>**对于化合物的电子结构、光谱性质、反应能力等涉及电子运动的研究，则应使用量子化学计算的方法。**然而，在许多情况下，将量子化学计算和分子力学计算结合使用能取得较好的效果。分子力学计算结果可提供量子化学计算所需的分子构象坐标，而量子化学计算结果又给出了分子力学所不能给出的分子的电子性质。
>
>分子力学是经典模型，以原子为“粒子”，按经典力学运动，而量子化学则主要处理对象为电子，其运动服从量子力学规律；
>
>量子化学中，电子或原子核间的相互作用服从库仑定律，而分子力学中每对原子之间有一特定的作用势函数，原子不同或者原子虽然相同但所处环境不同，则势函数不同，即使对同一对原子，也无法给出准确的普适势函数。

## 分子模拟

分子模拟(Molecular Simulation)为二十世纪初发展起来的一种计算机模拟方法，它泛指用于模拟分子或分子体系性质的方法，主要用于探索研究具有三维结构的分子结构和分子的性能。分子模拟是根据物理和化学的基本原理构建一个模型（通常是数学模型,是对某种分子体系或反应过程的理想化描述) ，建立一种以计算数据(由计算机来执行)来代替实验测量的研究方法,并获取相关的物理和化学信息。

分子模拟在材料科学方面的应用包括模拟材料的结构、计算材料的性质、预测材料的行为、验证实验结果（重现实验过程）、从微观角度认识材料，总之是为了更深层次理解材料的结构，认识材料的各种行为。分子模拟的主要优势在于可以降低实验成本、具有较高的安全性、实现通常条件下较难或无法进行的实验（例如：超低温，低于-100℃；超高压，高于100Mpa）、研究极快速的反应和变化等。

不同的分子模拟方法可以得到不同的信息。量子力学模拟方法可以计算得到分子的大多数性质，如结构、构象、偶极矩、电离能、电子亲和力、电子密度、过渡态和反应途径等；分子力学可以计算分子体系的稳定构象、热力学特性、振动光谱等；能量最小化可以探索相空间（phase space)和势能面（potential curve)，可以找出局部(local)与全局(global)的最小点及转化过程的马鞍点(saddle point)；Monte Carlo可以计算复杂分子体系的结构变化，特别是相变化；分子动力学可以得到复杂分子的热力学性质、结构、力学性质，特别是可以观察体系的动态演变，得到许多与时间有关的热动力学性质；布朗动力学可以研究蛋白质在水溶液中的折叠过程；构象分析可以研究复杂分子稳态和亚稳态结构之间的演变等等。

### 分子模拟方法

分子模拟的主要模拟方法有量子力学模拟和经典力学模拟，量子力学模拟主要根据从头算方法、半经验方法、DFT（Density Functional Theory,密度泛函数理论）方法，而经典力学模拟的方法主要依据分子力学、分子动力学、蒙地卡罗模拟、布朗动力学。

![](assets/1550909410356-1550924122495.png)

#### 量子力学方法

量子力学是利用波函数来研究微观粒子的运动规律的一个物理学分支学科，它以分子中电子的非定域化（delocalization）为基础，一切电子的行为以其波函数（wave function）表示。根据海森伯（Heisenberg）的测不准原理(uncertainly principle)，量子力学可计算区间内电子出现的概率，其概率正比于波函数绝对值的平方，而欲得到电子的波函数，则需解薛定谔方程式（Schrödinger equation）。

一般处理几个到几十个原子常见软件有GAUSSIAN, NWCHEM…

密度泛函(DFT)可以算到上百个原子，常见软件:VASP。

>波函数是量子力学中描写微观系统状态的函数。在经典力学中，用质点的位置和动量（或速度）来描写宏观质点的状态，这是质点状态的经典描述方式，它突出了质点的粒子性。由于微观粒子具有波粒二象性，粒子的位置和动量不能同时有确定值（见测不准关系），因而质点状态的经典描述方式不适用于对微观粒子状态的描述，物质波于宏观尺度下表现为对几率波函数的期望值，不确定性失效可忽略不计。

#### 分子力学方法

原则上, 第一原理方法在理论上已经能解决所有问题。但计算量太大，计算机资源有限，原子数目较多时，如高分子、蛋白质、原子簇以及研究表面问题、功能材料或材料的力学性能等，实际上难以完成计算。因为量子力学面对体系中的电子，即便是忽略一些电子的半经验方法仍然要处理大量的粒子，因而对大的体系难以实现。为此，发展了**分子力学(Molecular Mechanics, MM)与分子动力学(Molecular Dynamics, MD)方法**它们的应用，又称**分子模拟(molecular simulation, molecular modeling)  或  分子设计(molecular design)。**

MM与MD是经典力学方法，针对的最小结构单元不再是电子而是原子。因原子的质量比电子大很多，量子效应不明显，可近似用经典力学方法处理。

基本思想：事先构造出简单体系(如链段、官能团等各种不同结构的小片段)的势能函数, 简称 势函数 或 力场(force field)。将势函数建成数据库，在形成较大分子的势函数时，从数据库中检索到结构相同的片段，组合成大体系的势函数。利用分子势能随原子位置的变化有极小值的性质，确定大分子的结构即为分子力学(MM)。

利用势函数，建立并求解与温度和时间有关的牛顿运动方程，得到一定条件下体系的结构随时间的演化关系即为分子动力学(MD)。理论方法的核心是构造势函数（势函数即势能与原子位置的关系，往往是不知道的，需要通过其他方法，如量子化学方法及实验数据获得）。

>MM是确定分子结构的方法。利用分子势能随结构的变化而变化的性质，确定分子势能极小时的平衡结构(stationary point)。物理模型中，视原子为质点，视化学键为弹簧，而弹力常数完全由数据库中的分子力场来确定。因此是直接用势函数研究问题，不考虑原子的动能。不考虑动能所对应的结构，相当于体系处于 T=0 K 时的结果。
>
>分子力场是分子的静态势函数。而实际过程通常是在一定温度和一定压力下发生的。为了更切实际地了解体系运动和演化的过程，必须考虑体系中原子的运动，并与温度T和时间t建立联系。根据统计热力学，对于n个原子的体系，体系的温度T与各原子的运动速率vi的关系。又因体系中各原子的速率为*vi*时，动量$p_i=m_i v_i$，对应总动能*K*(*p*)。势能由力场确定为*E*(*x*)，因此体系的Hamilton量*H*。计算各原子的势能梯度, 得到原子在力场中所受的力。用牛顿方程求解其运动行为。
>
>分子力学忽略了电子的运动，只计算与原子核位置相关的体系能量。分子力学认为分子体系的势能函数是分子体系中原子位置的函数，将分子体系作为在势能面上运动的力学体系来处理，求解的是经典力学方程，而不是量子力学的薛定谔方程。
>
>分子力学从本质上说是能量最小值方法，即在原子间相互作用势的作用下, 通过改变粒子分布的几何位型, 以能量最小为判据, 从而获得体系的最佳结构。
>
>分子力学可以求得分子的平衡结构和热力学性质，但不能得到分子体系与电子结构相关的其他性质。

蒙地卡罗计算方法（Monte Carlo method）为最早针对庞大系统所采用的非量子计算方法,即MC计算法。蒙地卡罗计算法借由系统中质点（原子或分子）的随机运动，结合统计力学的概率分配原理来得到体系的统计及热力学资料，即根据待求问题的变化规律，构造合适的概率模型，然后进行大量统计实验，使模型的某些统计参量正好是待求问题的解。Monte Carlo模型的建立可以分为三个具体的操作步骤，首先将所研究的物理问题演变为类似的概率或统计模型；其次通过数值随机抽样实验对概率模型进行求解，其中包括大量的算术运算和逻辑操作；最后使用统计方法对得到的结果进行分析处理。这种计算方法可以研究复杂体系及金属的结构及其相变化性质。蒙地卡罗计算的弱点在于只能计算统计平均值，无法得到系统的动态信息。此计算所依据的随机运动并不适于物理学的运动原理，且与其他的非量子计算方法相比并非特别的经济快速，因此自从分子动力学计算逐渐盛行后，使用蒙地卡罗计算方法的人已逐渐减少。

还有一种与分子动力学模拟类似的计算方法为布朗动力模拟（Brownian dynamics simulation ,BD）。布朗动力模拟适用于大分子的溶液系统，计算中，将大分子的运动分为根据力场作用的运动与来自溶剂分子的随机力作用。通过布朗运动方程式可得到大分子运动的轨迹及一些统计与热力学的性质。布朗动力模拟通常适用于计算生化分子（如DNA、RNA、蛋白质、多肽）的水溶液。此算法的优点在于能计算大分子在较长时间范围内（纳秒级）的运动，其缺点为将溶剂分子的运动视为布朗运动粒子的假设未必是正确的。

